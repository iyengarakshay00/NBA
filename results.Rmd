# Results
Here we grab the data, which is referred to in the data section. We end up grabbing from espn and merging the tables together based on the teams, conferences, and years. This is talked about more in the data section.
```{r}
df_all = read.csv('./data/files/Season.csv')
df_all
```
We start with the first graph below based on the NBA data, where we see the fluctuations in points in a stacked bar chart where we see by year if the bar lengthens or gets smaller for PPG. This will help determine if offensive identity was different from the bubble than years past.
```{r}
# make a couple of graphs
#create a bar chart based on ppg per year per team
library(ggplot2)
library(tidyr)

ggplot(df_all, aes(x = PPG, y = ACT_TEAM, fill = YEAR)) +
  geom_bar(stat = "identity")
```
In the next graph, we want to plot opponents points per game versus points per game scored. We are going to take a specific look at 2019 so we can plot offensive and defensive prowess and see what teams in which conferences benefitted that year.
```{r}
# make a couple of graphs
#create a bar chart based on ppg per year per team
library(ggplot2)
library(tidyr)
#create longer field based on using tidy pacakge so we can plot points per game and points againsts
#filter by year so 2019 represents bubble and make graph clear by getting seperate east and west categorys
df_adj = gather(df_all, PPG_WL, VAL, PPG:OPP.PPG)
df_adj_2019_e = df_adj %>% 
  filter(YEAR == "2019") %>%
  filter(CAT == 'E')

df_adj_2019_w = df_adj %>% 
  filter(YEAR == "2019") %>%
  filter(CAT == 'W')

ggplot(df_adj_2019_e, aes(x = ACT_TEAM, y = VAL, fill = PPG_WL)) +
  geom_bar(stat = "identity", position = 'dodge')+
  ggtitle("EAST CONFERENCE BUBBLE PPG OFFENSIVE AND DEFENSIVE")

ggplot(df_adj_2019_w, aes(x = ACT_TEAM, y = VAL, fill = PPG_WL)) +
  geom_bar(stat = "identity", position = 'dodge')+
  ggtitle("WEST CONFERENCE BUBBLE PPG OFFENSIVE AND DEFENSIVE")
```

```{r}
# make a couple of graphs
#create a bar chart based on position for team
top_3 = select(df_all, ACT_TEAM, Position, YEAR, CAT) %>%
  filter(Position <= 3) %>%
  filter(YEAR == 2019)
top_3
#note teams equal MIL, TOR, LAL, LAC, BOS, DEN
teams = c('MIL', 'TOR', 'LAL','LAC','BOS','DEN')

# https://community.rstudio.com/t/how-to-filter-a-dataframe-based-on-a-list-of-values-from-one-column/79881/2- use link to help with filtering 

trend_team = select(df_all, ACT_TEAM, Position, W, YEAR, CAT) %>%
filter(ACT_TEAM %in% teams)

# https://stackoverflow.com/questions/27082601/ggplot2-line-chart-gives-geom-path-each-group-consist-of-only-one-observation - use this for numeric graph path conversion
trend_team$YEAR = as.numeric(as.character(trend_team$YEAR))
trend_team
ggplot(trend_team, aes(x = YEAR, y = Position, colors = ACT_TEAM))+
  geom_path(aes(color = ACT_TEAM))+
  scale_y_reverse()


```

```{r}
library(lubridate) 
# make a couple of graphs
#https://www.geeksforgeeks.org/how-to-add-labels-over-each-bar-in-barplot-in-r/- use this for geom_text
trend_team
ggplot(trend_team, aes(x = YEAR, y = W, colors = ACT_TEAM))+
  geom_path(aes(color = ACT_TEAM))+
  geom_text(aes(label = signif(W)), nudge_y = 1)


```

